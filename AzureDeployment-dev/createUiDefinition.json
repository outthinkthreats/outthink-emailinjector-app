{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
  "handler": "Microsoft.Azure.CreateUIDef",
  "version": "0.1.2-preview",
  "parameters": {
    "config": {
      "basics": {
        "description": "Configure OutThink Direct Mail Injection App deployment. **Note:** Only the Key Vault URL is required."
      }
    },
    "basics": [
      {
        "name": "sku",
        "type": "Microsoft.Common.DropDown",
        "label": "App Service Plan SKU",
        "toolTip": "Select the pricing tier for the App Service plan.",
        "constraints": {
          "allowedValues": [
            { "label": "Basic - B1 (1 Small)", "value": "B1" },
            { "label": "Basic - B2 (2 Medium)", "value": "B2" },
            { "label": "Standard - S1 (1 Small)", "value": "S1" },
            { "label": "Standard - S2 (2 Medium)", "value": "S2" }
          ],
          "required": true
        },
        "defaultValue": "B1",
        "visible": true
      },
      {
        "name": "keyVaultUrl",
        "type": "Microsoft.Common.TextBox",
        "label": "Key Vault URL",
        "toolTip": "URL of the Azure Key Vault (e.g. https://<your-vault>.vault.azure.net).",
        "constraints": {
          "required": true
        },
        "visible": true
      },
      {
        "name": "noteAppName",
        "type": "Microsoft.Common.TextBlock",
        "content": "The App Service will be named **outthink-emailinjectorapp** (this name is fixed).",
        "visible": true
      }
    ],
    "steps": [
      {
        "name": "optionalSettings",
        "label": "Optional Settings",
        "elements": [
          {
            "name": "apiBaseUrl",
            "type": "Microsoft.Common.TextBox",
            "label": "API Base URL",
            "toolTip": "Optional: Base URL for the email injector API (leave blank to use default).",
            "defaultValue": "https://outthink-api-public.ot-services-prd.net",
            "constraints": {
              "required": false
            },
            "visible": true
          }
        ]
      }
    ],
    "outputs": {
      "sku": "[basics('sku')]",
      "keyVaultUrl": "[basics('keyVaultUrl')]",
      "apiBaseUrl": "[steps('optionalSettings').apiBaseUrl]",
      "location": "[location()]"
    }
  }
}
